(()=>{var e={};e.id=5729,e.ids=[5729],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19166:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/monta/rabota/work3/redcastel/app/dashboard/admin/journal/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/monta/rabota/work3/redcastel/app/dashboard/admin/journal/page.tsx","default")},23717:(e,t,a)=>{Promise.resolve().then(a.bind(a,77008))},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},43649:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(62688).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},47033:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(62688).A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},48789:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var s=a(65239),l=a(48088),r=a(88170),i=a.n(r),n=a(30893),o={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);a.d(t,o);let d={children:["",{children:["dashboard",{children:["admin",{children:["journal",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,19166)),"/home/monta/rabota/work3/redcastel/app/dashboard/admin/journal/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,83249)),"/home/monta/rabota/work3/redcastel/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,58014)),"/home/monta/rabota/work3/redcastel/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["/home/monta/rabota/work3/redcastel/app/dashboard/admin/journal/page.tsx"],u={require:a,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:l.RouteKind.APP_PAGE,page:"/dashboard/admin/journal/page",pathname:"/dashboard/admin/journal",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},77008:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>D});var s=a(60687),l=a(43210),r=a(55192),i=a(24934),n=a(59821),o=a(70373),d=a(37826),c=a(61240),u=a(63974),m=a(40228),h=a(43649),p=a(47033),x=a(14952),b=a(11860),g=a(71702),f=a(1797),v=a(41013),y=a(15728),j=a(50848);let w={fr:{pageTitle:"Journal Administrateur",pageSubtitle:"G\xe9rez les plannings de vos employ\xe9s",weeklyTitle:"Planning Hebdomadaire",weeklySubtitle:"Horaires de travail par employ\xe9 et par jour",thEmployee:"Employ\xe9",filterByRestaurant:"Filtrer par Restaurant",allRestaurants:"Tous les restaurants",selectEmployee:"S\xe9lectionner un Employ\xe9",chooseEmployee:"Choisir un employ\xe9",employeesTitle:"Employ\xe9s",employeesSubtitle:"Cliquez sur un employ\xe9 pour modifier son planning",editorTitle:(e,t)=>`Planning de ${e} ${t}`,editorSubtitle:"D\xe9finissez les horaires de travail pour la semaine et le poste",weekRoleLabel:"Poste pour cette semaine",selectRole:"S\xe9lectionner un poste",selectShift:"S\xe9lectionner un cr\xe9neau",saveSchedule:"Sauvegarder le Planning",days:[{key:"monday",label:"Lundi"},{key:"tuesday",label:"Mardi"},{key:"wednesday",label:"Mercredi"},{key:"thursday",label:"Jeudi"},{key:"friday",label:"Vendredi"},{key:"saturday",label:"Samedi"},{key:"sunday",label:"Dimanche"}],shifts:[{value:"Matin",label:"Matin (09:00 - 18:00)"},{value:"Soir\xe9e",label:"Soir\xe9e (18:00 - 03:00)"},{value:"Doublage",label:"Doublage (09:00 - 03:00)"},{value:"Repos",label:"Repos"}],dash:"-",loading:"Chargement des donn\xe9es...",loadErrorTitle:"Erreur de chargement des donn\xe9es",missingDataTitle:"Erreur: Donn\xe9es manquantes du serveur",missingDataDesc:"V\xe9rifiez la connexion \xe0 la base de donn\xe9es ou contactez l'administrateur.",errTitle:"Erreur",selectEmployeeErr:"Veuillez s\xe9lectionner un employ\xe9",saveOkTitle:"Planning sauvegard\xe9",saveOkDesc:"Le planning a \xe9t\xe9 mis \xe0 jour avec succ\xe8s",saveErrTitle:"Erreur",saveErrDesc:"Impossible de sauvegarder le planning",monthlyPlan:"Planifier le mois",monthlyPlanSubtitle:e=>`Points: 1 = shift simple, 2 = doublage. Mois affich\xe9: ${e}`,legendSimple:"Shift simple",legendDouble:"Doublage",legendRest:"Repos / Non travaill\xe9",selectLocation:"Restaurant",selectShiftShort:"Shift",apply:"Appliquer",clear:"Effacer",confirmPlan:"Confirmer le planning",clearAll:"Vider le mois",prevMonth:"Mois pr\xe9c\xe9dent",nextMonth:"Mois suivant",locationAbbrev:"Rest.",notifPlanOk:"Planning du mois envoy\xe9 \xe0 l'employ\xe9",weeklyPlan:"Planning Hebdo"},ar:{pageTitle:"دفتر المسؤول",pageSubtitle:"إدارة جداول عمل الموظفين",weeklyTitle:"الجدول الأسبوعي",weeklySubtitle:"ساعات العمل لكل موظف ولكل يوم",thEmployee:"الموظف",filterByRestaurant:"تصفية حسب المطعم",allRestaurants:"جميع المطاعم",selectEmployee:"اختيار موظف",chooseEmployee:"اختر موظفًا",employeesTitle:"الموظفون",employeesSubtitle:"انقر على موظف لتعديل جدوله",editorTitle:(e,t)=>`جدول ${e} ${t}`,editorSubtitle:"حدد ساعات العمل للأسبوع والمنصب",weekRoleLabel:"المنصب لهذا الأسبوع",selectRole:"اختر منصبًا",selectShift:"اختر فترة",saveSchedule:"حفظ الجدول",days:[{key:"monday",label:"الإثنين"},{key:"tuesday",label:"الثلاثاء"},{key:"wednesday",label:"الأربعاء"},{key:"thursday",label:"الخميس"},{key:"friday",label:"الجمعة"},{key:"saturday",label:"السبت"},{key:"sunday",label:"الأحد"}],shifts:[{value:"Matin",label:"صباحي (09:00 - 18:00)"},{value:"Soir\xe9e",label:"مسائي (18:00 - 03:00)"},{value:"Doublage",label:"مزدوج (09:00 - 03:00)"},{value:"Repos",label:"راحة"}],dash:"-",loading:"جارٍ تحميل البيانات...",loadErrorTitle:"خطأ في تحميل البيانات",missingDataTitle:"خطأ: بيانات مفقودة من الخادم",missingDataDesc:"تحقق من الاتصال بقاعدة البيانات أو تواصل مع المسؤول.",errTitle:"خطأ",selectEmployeeErr:"يرجى اختيار موظف",saveOkTitle:"تم حفظ الجدول",saveOkDesc:"تم تحديث الجدول بنجاح",saveErrTitle:"خطأ",saveErrDesc:"تعذر حفظ الجدول",monthlyPlan:"تخطيط الشهر",monthlyPlanSubtitle:e=>`النقاط: 1 = فترة واحدة، 2 = مزدوج. الشهر المعروض: ${e}`,legendSimple:"فترة واحدة",legendDouble:"مزدوج",legendRest:"راحة / غير عامل",selectLocation:"مطعم",selectShiftShort:"الفترة",apply:"تطبيق",clear:"مسح",confirmPlan:"تأكيد التخطيط",clearAll:"مسح الشهر",prevMonth:"الشهر السابق",nextMonth:"الشهر التالي",locationAbbrev:"مطعم",notifPlanOk:"تم إرسال تخطيط الشهر للموظف",weeklyPlan:"الجدول الأسبوعي"}};function N(e){let t=e.getFullYear(),a=e.getMonth(),s=new Date(t,a,1),l=new Date(t,a+1,0),r=(s.getDay()+6)%7,i=l.getDate(),n=[];for(let e=0;e<r;e++)n.push(null);for(let e=1;e<=i;e++)n.push(new Date(t,a,e));return{year:t,month:a,first:s,last:l,grid:n,daysInMonth:i}}function S(e){let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${a}-${s}`}function k(e){if(null==e)return"";if("string"==typeof e){if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;let t=Number(e);if(Number.isFinite(t))return S(new Date(String(e).length>=12?t:1e3*t));let a=Date.parse(e);return Number.isNaN(a)?e:S(new Date(a))}if("number"==typeof e&&Number.isFinite(e))return S(new Date(e));try{let t=new Date(String(e));if(!Number.isNaN(t.getTime()))return S(t)}catch{}return""}function _(e,t=3){return e&&"string"==typeof e&&e.trim()?(e.trim().split(/\s+/).map(e=>e[0]?.toUpperCase()).join("")||e.slice(0,t).toUpperCase()).slice(0,t):""}function D(){let e=w[function(){let[e,t]=(0,l.useState)("fr");return e}()],{toast:t}=(0,g.dj)(),[a,D]=(0,l.useState)(""),[P,R]=(0,l.useState)(""),[E,M]=(0,l.useState)({}),[$,C]=(0,l.useState)(""),[A,T]=(0,l.useState)(!1),[O,z]=(0,l.useState)(()=>{let e=new Date;return e.setDate(1),e}),[q,I]=(0,l.useState)({}),[L,U]=(0,l.useState)(null),[F,B]=(0,l.useState)(!1),[G,V]=(0,l.useState)(!1),[W,H]=(0,l.useState)(!1),[Y,J]=(0,l.useState)([]),[Z,K]=(0,l.useState)({}),[X,Q]=(0,l.useState)(0),[ee,et]=(0,l.useState)([]),{data:ea,error:es,loading:el}=(0,f.I)(j.dO,{fetchPolicy:"cache-first",errorPolicy:"all",notifyOnNetworkStatusChange:!1}),{data:er,error:ei,loading:en}=(0,f.I)(j.Yh,{fetchPolicy:"cache-first",errorPolicy:"all"}),eo=new Date,ed=new Date(eo);ed.setDate(eo.getDate()-eo.getDay()+1);let ec=new Date(ed);ec.setDate(ed.getDate()+6);let eu=ed.toISOString().slice(0,10),em=ec.toISOString().slice(0,10),{data:eh,error:ep,loading:ex,refetch:eb}=(0,f.I)(j.Ut,{variables:{start:eu,end:em},fetchPolicy:"cache-first",errorPolicy:"all"}),[eg,{data:ef}]=(0,v._)(j.gG),[ev]=(0,y.n)(j.Dl),[ey]=(0,y.n)(j.eU),[ej]=(0,y.n)(j.HR),ew=(0,l.useMemo)(()=>(er?.locations??[]).map(e=>({id:String(e.id),name:String(e.name??""),short_name:String(e.short_name??"")})),[er]),eN=(0,l.useMemo)(()=>ew.slice(0,3),[ew]),eS=e.days,ek=e.shifts,[e_,eD]=(0,l.useState)([]),[eP,eR]=(0,l.useState)(""),eE=(0,l.useMemo)(()=>(ea?.employees??[]).map(e=>({id:e.id,name:`${e.prenom} ${e.nom}`,position:e.job_title,location:e.location?.name||"",job_title:e.job_title,prenom:e.prenom,nom:e.nom,profile:e.profile,locationObj:e.location})),[ea]);(0,l.useMemo)(()=>Array.from(new Set(eE.map(e=>e.job_title).filter(Boolean))),[eE]),(0,l.useMemo)(()=>Array.from(new Set(eE.map(e=>e.location))).filter(Boolean),[eE]);let eM=(0,l.useMemo)(()=>P&&"all"!==P?eE.filter(e=>e.location===P):eE,[eE,P]),e$=(0,l.useMemo)(()=>eM.find(e=>e.id===a),[eM,a]),eC=async s=>{let l=s||a;if(!l){t({title:e.errTitle,description:e.selectEmployeeErr,variant:"destructive"});return}try{B(!0),s&&D(s);let{first:e,last:t}=N(O),a=e.toISOString().slice(0,10),r=t.toISOString().slice(0,10),i=await eg({variables:{employee_id:l,start:a,end:r}}),n=i.data?.workSchedulesRange??[],o={};n.forEach(e=>{if(e?.date){let t=k(e.date);t&&(o[t]={shift:e.shift_type??"Repos",location_id:"Repos"===e.shift_type?"0":e.location_id?.toString()??void 0,job_position:e.job_position??void 0})}}),I(o),T(!0)}finally{B(!1)}},eA=e=>{let t=new Date(O);t.setMonth(t.getMonth()+e),z(t),U(null)},eT=(e,t)=>{I(a=>{let s={...a};return t?"Repos"===t.shift?s[e]={...t,location_id:"0"}:s[e]=t:delete s[e],s}),U(null)},eO=async()=>{if(!a){t({title:e.errTitle,description:e.selectEmployeeErr,variant:"destructive"});return}try{let s=Object.entries(q);if(0===s.length){T(!1),await eb();return}let l=e$?.locationObj?.id||ew[0]?.id;if(!l){t({title:e.saveErrTitle,description:"Aucun restaurant trouv\xe9 pour cet employ\xe9",variant:"destructive"});return}let r=s.map(([e,t])=>{let s=k(e);if(!s)return null;let r=null,i=null,n=!0;"Matin"===t.shift?(r="09:00",i="18:00"):"Soir\xe9e"===t.shift?(r="18:00",i="03:00"):"Doublage"===t.shift?(r="09:00",i="03:00"):(r=null,i=null,n=!1);let o="Repos"===t.shift?"0":t.location_id&&"0"!==t.location_id?String(t.location_id):String(l),d=new Date(s).toLocaleDateString("en-US",{weekday:"long"});return{employee_id:String(a),date:s,start_time:r,end_time:i,shift_type:t.shift,job_position:$||e$?.job_title||"",is_working:n,location_id:o,day:d,retard:null,status:"active"}}).filter(Boolean);await ev({variables:{employee_id:a,schedules:r}});let i=`${O.getFullYear()}-${String(O.getMonth()+1).padStart(2,"0")}`;await ej({variables:{employee_id:a,month:i}}),t({title:e.saveOkTitle,description:e.notifPlanOk});let{first:n,last:o}=N(O),d=n.toISOString().slice(0,10),c=o.toISOString().slice(0,10),u=await eg({variables:{employee_id:a,start:d,end:c}}),m=u.data?.workSchedulesRange??[],h={};m.forEach(e=>{if(e?.date){let t=k(e.date);t&&(h[t]={shift:e.shift_type??"Repos",location_id:"Repos"===e.shift_type?"0":e.location_id?.toString()??void 0,job_position:e.job_position??void 0})}}),I(h),await eb()}catch(a){console.error("Error saving month schedule:",a),t({title:e.saveErrTitle,description:e.saveErrDesc,variant:"destructive"})}};return(0,l.useMemo)(()=>{let e=S(new Date),t={};if(ea?.employees&&eh?.allUserWorkSchedules){let a=ea.employees,s=eh.allUserWorkSchedules;a.forEach(a=>{s.find(t=>String(t.employee_id)===String(a.id)&&k(t.date)===e)||(t[a.id]=!0)})}return t},[ea,eh]),(0,l.useMemo)(()=>()=>{let e=Date.now();return e-X<3e4?Promise.resolve():(Q(e),eb())},[eb,X]),(0,s.jsxs)("div",{className:"min-h-screen relative overflow-hidden",dir:"ltr",children:[(0,s.jsxs)("div",{className:"absolute inset-0 pointer-events-none z-0",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-slate-900/80 via-purple-900/60 to-slate-900/80 backdrop-blur-[6px]"}),[...Array(20)].map((e,t)=>(0,s.jsx)("div",{className:"absolute w-1 h-1 bg-gradient-to-r from-blue-400 to-purple-400 rounded-full opacity-30 animate-float",style:{left:`${100*Math.random()}%`,top:`${100*Math.random()}%`,animationDelay:`${6*Math.random()}s`,animationDuration:`${6+4*Math.random()}s`}},t))]}),(0,s.jsxs)("div",{className:"space-y-6 p-4 relative z-20 max-w-full mx-auto",children:[(0,s.jsxs)("div",{className:"glass-card backdrop-blur-futuristic p-4 lg:p-6 text-white shadow-2xl animate-fade-in relative overflow-hidden border border-white/10",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-900/30 via-purple-900/40 to-blue-900/30 opacity-70 rounded-2xl"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent translate-x-[-100%] animate-[shimmer_3s_ease-in-out_infinite] rounded-2xl"}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-3 sm:space-y-0 sm:space-x-4 relative z-10",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-700/40 to-purple-700/40 rounded-xl flex items-center justify-center border border-white/10 flex-shrink-0",children:(0,s.jsx)(m.A,{className:"w-6 h-6 text-white"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h1",{className:"text-2xl md:text-3xl font-bold mb-1 bg-gradient-to-r from-white via-blue-200 to-purple-200 bg-clip-text text-transparent",dir:"auto",children:e.pageTitle}),(0,s.jsx)("p",{className:"text-slate-200 text-sm md:text-base",dir:"auto",children:e.pageSubtitle})]}),Object.keys(Z).length>0&&(0,s.jsxs)("div",{className:"flex items-center space-x-2 bg-orange-600/20 border border-orange-500/30 rounded-lg px-3 py-2 w-full sm:w-auto",children:[(0,s.jsx)(h.A,{className:"w-4 h-4 sm:w-5 sm:h-5 text-orange-400 flex-shrink-0"}),(0,s.jsxs)("div",{className:"text-sm min-w-0",children:[(0,s.jsxs)("div",{className:"text-orange-200 font-medium",children:[Object.keys(Z).length," employ\xe9(s)"]}),(0,s.jsx)("div",{className:"text-orange-300 text-xs truncate",children:"Besoin d'assignation restaurant"})]})]})]})]}),(0,s.jsxs)(r.Zp,{className:"glass-card backdrop-blur-futuristic border border-white/10 shadow-2xl bg-gradient-to-br from-slate-900/70 via-purple-900/60 to-slate-900/70",children:[(0,s.jsxs)(r.aR,{children:[(0,s.jsx)(r.ZB,{dir:"auto",children:e.weeklyTitle}),(0,s.jsx)(r.BT,{dir:"auto",children:e.weeklySubtitle})]}),(0,s.jsx)(r.Wu,{children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full border-collapse text-white",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("th",{className:"text-left p-3 font-semibold",dir:"auto",children:e.thEmployee}),eS.map(e=>(0,s.jsx)("th",{className:"text-center p-3 font-semibold",dir:"auto",children:e.label},e.key))]})}),(0,s.jsx)("tbody",{children:eE.map(t=>{let a=Z[t.id];return(0,s.jsxs)("tr",{className:`border-b hover:bg-white/5 transition-colors ${a?"bg-orange-900/20 border-orange-500/30":""}`,children:[(0,s.jsx)("td",{className:"p-3",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(o.eu,{className:"w-8 h-8",children:(0,s.jsx)(o.q5,{className:"text-xs bg-gradient-to-br from-blue-700/60 to-purple-700/60 text-white",children:t.name.split(" ").map(e=>e[0]).join("")})}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("p",{className:"font-medium text-sm truncate",dir:"auto",children:t.name}),a&&(0,s.jsx)(h.A,{className:"w-4 h-4 text-orange-400 flex-shrink-0"})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground truncate",dir:"auto",children:t.position||e.dash}),(0,s.jsx)("div",{className:"mt-2 flex gap-2",children:(0,s.jsx)(i.$,{size:"sm",variant:"secondary",className:`${a?"bg-orange-700/40 hover:bg-orange-700/50 text-orange-100 border border-orange-500/40":"bg-emerald-700/30 hover:bg-emerald-700/40 text-emerald-100 border border-emerald-500/30"}`,onClick:()=>{eC(t.id)},children:a?"Planning Urgent":"Planning"})})]})]})}),eS.map(l=>{let r=function(e,t){if(!eh?.allUserWorkSchedules)return null;let a=eS.findIndex(e=>e.key===t);if(-1===a)return null;let s=new Date(ed);s.setDate(ed.getDate()+a),s.setHours(0,0,0,0);let l=S(s),r=eh.allUserWorkSchedules.find(t=>String(t.employee_id)===String(e)&&k(t.date)===l);return r&&String(r.employee_id)!==String(e)?null:r?{shift:r.shift_type,job:r.job_position,location_id:r.location_id}:null}(t.id,l.key),i=(new Date().getDay()+6)%7,o=eS.findIndex(e=>e.key===l.key)===i,d=o&&a;return(0,s.jsxs)("td",{className:`text-center p-3 ${d?"bg-orange-900/30 border border-orange-500/30 rounded":""}`,children:[r?(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(n.E,{variant:"Repos"===r.shift?"outline":"default",className:`text-xs ${"Matin"===r.shift?"bg-blue-700/30 text-blue-200":"Soir\xe9e"===r.shift?"bg-purple-700/30 text-purple-200":"Doublage"===r.shift?"bg-orange-700/30 text-orange-200":"Repos"===r.shift?"bg-gray-700/30 text-gray-200 border-gray-500/50":"bg-slate-700/30 text-slate-200"}`,children:r.shift}),r.job&&"Repos"!==r.shift&&(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:r.job}),"Repos"===r.shift&&(0,s.jsx)("div",{className:"text-xs font-bold text-gray-300",children:"REP"})]}):(0,s.jsx)("span",{className:"text-muted-foreground text-xs",children:e.dash}),o&&t.location&&r?.shift!=="Repos"&&(0,s.jsx)("div",{className:"text-xs text-blue-300 mt-1",children:_(t.location.name,3)})]},l.key)})]},t.id)})})]})})})]})]}),(0,s.jsx)(d.lG,{open:A,onOpenChange:T,children:(0,s.jsxs)(d.Cf,{className:"w-[98vw] max-w-6xl mx-auto max-h-[95vh] overflow-y-auto glass-card bg-gradient-to-br from-slate-900/95 via-slate-900/90 to-slate-900/95 border border-white/10 text-white p-0",children:[(0,s.jsxs)(d.c7,{className:"sticky top-0 z-10 bg-gradient-to-b from-slate-900/95 via-slate-900/90 to-slate-900/80 backdrop-blur-md border-b border-white/10 px-4 py-4",children:[(0,s.jsx)(d.L3,{children:e$?`Planning du mois — ${e$.prenom} ${e$.nom}`:e.monthlyPlan}),(0,s.jsx)(d.rr,{children:e.monthlyPlanSubtitle(eP)}),a&&Z[a]&&(0,s.jsxs)("div",{className:"flex items-center space-x-2 bg-orange-600/20 border border-orange-500/30 rounded-lg px-3 py-2 mt-2",children:[(0,s.jsx)(h.A,{className:"w-4 h-4 text-orange-400"}),(0,s.jsx)("span",{className:"text-sm text-orange-200",children:"Cet employ\xe9 a besoin d'une assignation restaurant pour aujourd'hui"})]})]}),(0,s.jsxs)("div",{className:"px-4 py-4 space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"inline-block w-2.5 h-2.5 rounded-full bg-emerald-400"}),(0,s.jsx)("span",{className:"text-xs text-slate-300",children:e.legendSimple})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("span",{className:"inline-flex flex-col gap-0.5",children:[(0,s.jsx)("span",{className:"block w-2.5 h-2 rounded-full bg-cyan-400"}),(0,s.jsx)("span",{className:"block w-2.5 h-2 rounded-full bg-cyan-400"})]}),(0,s.jsx)("span",{className:"text-xs text-slate-300",children:e.legendDouble})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"inline-block w-2.5 h-2.5 rounded-full bg-slate-500"}),(0,s.jsx)("span",{className:"text-xs text-slate-300",children:e.legendRest})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(i.$,{variant:"ghost",size:"icon",onClick:()=>eA(-1),"aria-label":e.prevMonth,children:(0,s.jsx)(p.A,{className:"w-4 h-4"})}),(0,s.jsx)("div",{className:"px-3 py-1.5 rounded-md bg-white/5 border border-white/10 text-sm",children:eP}),(0,s.jsx)(i.$,{variant:"ghost",size:"icon",onClick:()=>eA(1),"aria-label":e.nextMonth,children:(0,s.jsx)(x.A,{className:"w-4 h-4"})})]})]}),(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsxs)("div",{className:"grid grid-cols-7 gap-1 text-xs text-slate-400 mb-2",children:[(0,s.jsx)("div",{className:"text-center",children:"Lun"}),(0,s.jsx)("div",{className:"text-center",children:"Mar"}),(0,s.jsx)("div",{className:"text-center",children:"Mer"}),(0,s.jsx)("div",{className:"text-center",children:"Jeu"}),(0,s.jsx)("div",{className:"text-center",children:"Ven"}),(0,s.jsx)("div",{className:"text-center",children:"Sam"}),(0,s.jsx)("div",{className:"text-center",children:"Dim"})]}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1",children:e_.map((t,l)=>{if(!t)return(0,s.jsx)("div",{},`empty-${l}`);let r=S(t),n=q[r],o=n?.shift,d=r===S(new Date),m=d&&a&&Z[a];return(0,s.jsxs)(c.AM,{open:L===r,onOpenChange:e=>U(e?r:null),children:[(0,s.jsx)(c.Wv,{asChild:!0,children:(0,s.jsxs)("button",{className:`relative rounded-lg px-1 pt-2 pb-4 text-left transition-colors h-16 sm:h-20 w-full ${m?"bg-orange-600/20 hover:bg-orange-600/30 border-2 border-orange-500/50 animate-pulse":d?"bg-blue-600/20 hover:bg-blue-600/30 border-2 border-blue-500/50":"bg-white/5 hover:bg-white/10 border border-white/10"}`,onClick:()=>U(r),children:[(0,s.jsx)("span",{className:`text-xs font-medium block ${m?"text-orange-200":d?"text-blue-200":"text-slate-200"}`,children:t.getDate()}),d&&(0,s.jsx)("span",{className:"absolute top-1 right-1 w-1.5 h-1.5 bg-blue-400 rounded-full"}),m&&(0,s.jsx)(h.A,{className:"absolute top-1 right-1 w-3 h-3 text-orange-400"}),(0,s.jsx)("div",{className:"absolute left-1 bottom-1 flex flex-col items-start gap-0.5",children:"Doublage"===o?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"w-2 h-2 rounded-full bg-cyan-400 shadow-[0_0_8px_rgba(34,211,238,0.6)]"}),(0,s.jsx)("span",{className:"w-2 h-2 rounded-full bg-cyan-400 shadow-[0_0_8px_rgba(34,211,238,0.6)]"})]}):"Matin"===o||"Soir\xe9e"===o?(0,s.jsx)("span",{className:"w-2 h-2 rounded-full bg-emerald-400 shadow-[0_0_8px_rgba(16,185,129,0.6)]"}):"Repos"===o?(0,s.jsx)("span",{className:"w-2 h-2 rounded-full bg-slate-500 shadow-[0_0_8px_rgba(100,116,139,0.6)]"}):null}),n?.location_id&&n?.location_id!=="0"&&(0,s.jsx)("span",{className:"absolute right-1 bottom-1 text-[9px] px-1 py-0.5 rounded-md bg-slate-800/70 text-slate-100 border border-white/10",title:ew.find(e=>e.id===n.location_id)?.name??"","aria-label":`Restaurant ${ew.find(e=>e.id===n.location_id)?.name??""}`,children:_(ew.find(e=>e.id===n.location_id)?.name??"",3)}),(n?.location_id==="0"||n?.shift==="Repos")&&(0,s.jsx)("span",{className:"absolute right-1 bottom-1 text-[10px] font-bold text-white bg-gray-600/80 px-1 rounded",title:"Repos",children:"REP"})]})}),(0,s.jsx)(c.hl,{className:"w-80 p-0 bg-gradient-to-br from-slate-900/95 to-slate-900/95 border border-white/10 text-white",children:(0,s.jsxs)("div",{className:"p-3 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"text-sm text-slate-300",children:new Intl.DateTimeFormat("fr-FR",{weekday:"long",day:"2-digit",month:"long"}).format(t)}),(0,s.jsx)(i.$,{variant:"ghost",size:"icon",onClick:()=>U(null),children:(0,s.jsx)(b.A,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400 uppercase tracking-wide",children:e.selectShiftShort}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2",children:ek.map(e=>(0,s.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>eT(r,{shift:e.value,location_id:"Repos"===e.value?0:e$?.locationObj?.id,job_position:e$?.job_title}),className:`text-xs h-8 ${n?.shift===e.value?"bg-blue-600/30 border-blue-500/50 text-blue-200":"bg-white/5 border-white/10 text-slate-300 hover:bg-white/10"}`,children:e.value},e.value))})]}),eN.length>0&&n?.shift!=="Repos"&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-xs text-slate-400 uppercase tracking-wide",children:e.selectLocation}),(0,s.jsxs)(u.l6,{value:n?.location_id&&n?.location_id!=="0"?n.location_id:"",onValueChange:e=>{n&&eT(r,{...n,location_id:e})},children:[(0,s.jsx)(u.bq,{className:"h-8 text-xs bg-white/5 border-white/10 text-white",children:(0,s.jsx)(u.yv,{placeholder:"Choisir restaurant"})}),(0,s.jsx)(u.gC,{className:"bg-slate-900 border-white/10",children:eN.map(e=>(0,s.jsx)(u.eb,{value:e.id,className:"text-white hover:bg-white/10",children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,s.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>eT(r,null),className:"flex-1 h-8 text-xs bg-white/5 border-white/10 text-slate-300 hover:bg-white/10",children:e.clear}),(0,s.jsx)(i.$,{size:"sm",onClick:()=>U(null),className:"flex-1 h-8 text-xs bg-blue-600 hover:bg-blue-700 text-white",children:e.apply})]})]})})]},r)})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-white/10",children:[(0,s.jsx)(i.$,{variant:"outline",onClick:()=>{I({}),U(null)},className:"text-slate-300 border-white/20 hover:bg-white/10 bg-transparent",children:e.clearAll}),(0,s.jsx)(i.$,{variant:"outline",className:"text-slate-300 border-white/20 hover:bg-white/10 bg-transparent",children:"mois prochain"}),(0,s.jsx)(i.$,{variant:"outline",className:"text-slate-300 border-white/20 hover:bg-white/10 bg-transparent",children:"ann\xe9e"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(i.$,{variant:"outline",onClick:()=>T(!1),className:"text-slate-300 border-white/20 hover:bg-white/10 bg-transparent",children:"Annuler"}),(0,s.jsx)(i.$,{onClick:eO,disabled:F,className:"bg-blue-600 hover:bg-blue-700 text-white",children:F?"Sauvegarde...":e.confirmPlan})]})]})]})]})})]})}},87269:(e,t,a)=>{Promise.resolve().then(a.bind(a,19166))}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[7719,9922,4774,5806,4803,1536,972,4537,3789],()=>a(48789));module.exports=s})();